From 9dee649674682f58d9e7d532e3f2ef27078675d7 Mon Sep 17 00:00:00 2001
From: Richard Hughes <richard@hughsie.com>
Date: Tue, 17 Sep 2013 16:08:15 +0100
Subject: [PATCH] updates: Do not clear the offline-update if rebooting
 succeeded

---
 plugins/updates/gsd-updates-manager.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/plugins/updates/gsd-updates-manager.c b/plugins/updates/gsd-updates-manager.c
index 9c8ab79..3aff29a 100644
--- a/plugins/updates/gsd-updates-manager.c
+++ b/plugins/updates/gsd-updates-manager.c
@@ -1324,8 +1324,10 @@ reboot_failed (GObject *source, GAsyncResult *res, gpointer data)
         GError *error = NULL;
 
         ret = g_dbus_connection_call_finish (G_DBUS_CONNECTION (source), res, &error);
-        if (ret)
+        if (ret) {
                 g_variant_unref (ret);
+                return;
+        }
 
         if (error) {
                 g_warning ("Calling org.gnome.SessionManager.Reboot failed: %s\n", error->message);
-- 
1.8.3.1

